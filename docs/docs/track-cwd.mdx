---
sidebar_position: 8
id: "track-cwd"
title: "Tracking Your Shell's Working Directory"
---

# Tracking Your Shell's Working Directory

Wave requires a special terminal escape sequence (OSC 7) to keep its internal working directory (`cmd:cwd`) in sync with your shell’s directory. Without this, new tabs or splits always start in your home directory.

## Why OSC 7 is needed

Most terminals emit an OSC 7 escape whenever the shell's current directory changes. Wave listens for these sequences to update its `cmd:cwd` metadata. That metadata is copied to new blocks when you:

- Open a new tab (Alt T / Cmd T)
- Open a new terminal block (Alt N / Cmd N)
- Split a pane (Cmd D / Cmd Shift D)

If OSC 7 isn’t enabled, Wave has no way to know your shell’s current directory and falls back to `~`.

## Enabling OSC 7 in your shell

Add the following snippets to your shell startup/config file and restart Wave (or source your config).

### Bash

Add to `~/.bashrc` or `~/.bash_profile`:

```bash
# Emit OSC 7 on each prompt
export PROMPT_COMMAND='printf "\033]7;file://$HOSTNAME$PWD\007"'
```

### Zsh

Add to `~/.zshrc`:

```zsh
# Function to emit OSC 7
function _wave_emit_cwd() {
  printf "\033]7;file://%s%s\007" "$HOST" "${PWD// /%20}"
}

# Emit when directory changes
autoload -U add-zsh-hook
add-zsh-hook chpwd _wave_emit_cwd

# Emit once on startup
_wave_emit_cwd
```

### Fish

> **Note:** Fish shell (version 4.0.0 and later) emits the OSC 7 working-directory escape by default. No additional configuration is required. See [Fish Release Notes](https://fishshell.com/docs/current/relnotes.html#improved-terminal-support) for more details.

If you are running an older fish release, you can add the following to `~/.config/fish/config.fish`:

```fish
function _wave_emit_cwd --on-variable PWD
    printf "\033]7;file://%s%s\007" (hostname) (string replace ' ' '%20' $PWD)
end

# Emit on startup
_wave_emit_cwd
```

## Verifying in Wave

1. Open a Wave terminal block.
2. `cd` into a project folder, e.g. `cd ~/projects/foo`.
3. Right-click on the block's title bar and select "Copy BlockId" to retrieve the block’s ID.
4. Use the copied BlockId to retrieve the block’s metadata:

   ```bash
   # Example: replace <block-id> with your actual block reference
   wsh getmeta --block <block-id>
   ```

5. Confirm the output JSON contains a `cmd:cwd` field, for example:

   ```json
   {
     "cmd:cwd": "/Users/you/projects/foo",
     ...
   }
   ```

6. Open a new tab or split the pane—both should start in `/Users/you/projects/foo`.
